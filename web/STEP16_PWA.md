# ğŸ“± Step 16 å®Œæˆç¸½çµï¼šProgressive Web App (PWA) åŠŸèƒ½
## PWA Features - Implementation Summary

---

## âœ… å·²å®Œæˆé …ç›®

### 1. PWA åŸºç¤æ¶æ§‹

#### å·²å¯¦ç¾çš„æ ¸å¿ƒåŠŸèƒ½
- âœ… Web App Manifest (manifest.json)
- âœ… Service Worker (sw.js)
- âœ… é›¢ç·šå¿«å–ç­–ç•¥
- âœ… App åœ–ç¤ºï¼ˆ192x192ã€512x512ï¼‰
- âœ… "åŠ åˆ°ä¸»ç•«é¢" æç¤º
- âœ… ç¨ç«‹è¦–çª—æ¨¡å¼
- âœ… æ‡‰ç”¨ç¨‹å¼æ›´æ–°é€šçŸ¥

---

### 2. Web App Manifest

#### æª”æ¡ˆï¼š[manifest.json](manifest.json)

**å®Œæ•´é…ç½®ï¼š**
```json
{
  "name": "å°åŒ—è–èª•ä¹‹æ—… 2025",
  "short_name": "å°åŒ—è–èª•éŠ",
  "description": "8äººåœ˜å¥‘å°åŒ—è–èª•å››æ—¥éŠå®Œæ•´æŒ‡å—",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#c41e3a",
  "theme_color": "#c41e3a",
  "orientation": "portrait-primary",
  "icons": [
    {
      "src": "/images/icons/icon-192.svg",
      "sizes": "192x192",
      "type": "image/svg+xml",
      "purpose": "any"
    },
    {
      "src": "/images/icons/icon-512.svg",
      "sizes": "512x512",
      "type": "image/svg+xml",
      "purpose": "maskable"
    }
  ],
  "categories": ["travel", "lifestyle"],
  "lang": "zh-TW",
  "dir": "ltr",
  "scope": "/",
  "prefer_related_applications": false
}
```

**å±¬æ€§èªªæ˜ï¼š**

| å±¬æ€§ | å€¼ | èªªæ˜ |
|------|-----|------|
| `name` | å°åŒ—è–èª•ä¹‹æ—… 2025 | å®Œæ•´æ‡‰ç”¨ç¨‹å¼åç¨± |
| `short_name` | å°åŒ—è–èª•éŠ | ä¸»ç•«é¢é¡¯ç¤ºåç¨±ï¼ˆç°¡çŸ­ç‰ˆï¼‰ |
| `description` | 8äººåœ˜å¥‘å°åŒ—è–èª•å››æ—¥éŠå®Œæ•´æŒ‡å— | æ‡‰ç”¨ç¨‹å¼æè¿° |
| `start_url` | / | å•Ÿå‹•æ™‚çš„ URL |
| `display` | standalone | ç¨ç«‹è¦–çª—æ¨¡å¼ï¼ˆç„¡ç€è¦½å™¨ UIï¼‰ |
| `background_color` | #c41e3a | å•Ÿå‹•ç•«é¢èƒŒæ™¯è‰²ï¼ˆè–èª•ç´…ï¼‰ |
| `theme_color` | #c41e3a | ä¸»é¡Œé¡è‰²ï¼ˆå½±éŸ¿ç³»çµ± UIï¼‰ |
| `orientation` | portrait-primary | é è¨­ç›´å‘é¡¯ç¤º |
| `categories` | travel, lifestyle | æ‡‰ç”¨ç¨‹å¼åˆ†é¡ |
| `lang` | zh-TW | ç¹é«”ä¸­æ–‡ |
| `scope` | / | æ‡‰ç”¨ç¨‹å¼ç¯„åœ |

---

### 3. Service Worker å¿«å–ç­–ç•¥

#### æª”æ¡ˆï¼š[sw.js](sw.js)

**ç‰ˆæœ¬ï¼š** v1.1.0

**å¿«å–è³‡æºæ¸…å–®ï¼š**
```javascript
const PRECACHE_URLS = [
    '/',                          // é¦–é 
    '/index.html',                // HTML
    '/css/main.css',              // ä¸»è¦æ¨£å¼
    '/css/responsive.css',        // éŸ¿æ‡‰å¼æ¨£å¼
    '/css/print.css',             // åˆ—å°æ¨£å¼
    '/js/main.js',                // ä¸»è¦è…³æœ¬
    '/js/map.js',                 // åœ°åœ–åŠŸèƒ½
    '/js/calculator.js',          // è¨ˆç®—å™¨
    '/js/lightbox.js',            // ç‡ˆç®±ç•«å»Š
    '/js/print.js',               // åˆ—å°åŠŸèƒ½
    '/js/pwa-install.js',         // PWA å®‰è£
    '/data/itinerary.json',       // è¡Œç¨‹è³‡æ–™
    '/manifest.json',             // Manifest
    '/images/icons/icon-192.svg', // App åœ–ç¤º
    '/images/icons/icon-512.svg'  // App åœ–ç¤º
];
```

**ä¸‰ç¨®å¿«å–ç­–ç•¥ï¼š**

##### 1. Cache-Firstï¼ˆå¿«å–å„ªå…ˆï¼‰
**é©ç”¨ï¼š** éœæ…‹è³‡æºï¼ˆCSSã€JSã€åœ–ç‰‡ï¼‰

```javascript
async function cacheFirst(request) {
    const cache = await caches.open(CACHE_NAME);
    const cached = await cache.match(request);
    
    if (cached) {
        return cached;  // å„ªå…ˆè¿”å›å¿«å–
    }
    
    const response = await fetch(request);
    if (response.status === 200) {
        cache.put(request, response.clone());
    }
    return response;
}
```

**å„ªå‹¢ï¼š**
- âš¡ æœ€å¿«çš„è¼‰å…¥é€Ÿåº¦
- ğŸ“± å®Œå…¨é›¢ç·šå¯ç”¨
- ğŸ’¾ æ¸›å°‘ç¶²è·¯è«‹æ±‚

##### 2. Network-Firstï¼ˆç¶²è·¯å„ªå…ˆï¼‰
**é©ç”¨ï¼š** å‹•æ…‹å…§å®¹ï¼ˆHTMLã€JSONï¼‰

```javascript
async function networkFirst(request) {
    const cache = await caches.open(RUNTIME_CACHE);
    
    try {
        const response = await fetch(request);
        if (response.status === 200) {
            cache.put(request, response.clone());
        }
        return response;
    } catch (error) {
        const cached = await cache.match(request);
        if (cached) {
            return cached;  // ç¶²è·¯å¤±æ•—æ™‚è¿”å›å¿«å–
        }
        throw error;
    }
}
```

**å„ªå‹¢ï¼š**
- ğŸ”„ ç¢ºä¿å…§å®¹æœ€æ–°
- ğŸ“¶ é›¢ç·šæ™‚ä»å¯è¨ªå•
- âš–ï¸ å¹³è¡¡æ–°é®®åº¦èˆ‡å¯ç”¨æ€§

##### 3. Stale-While-Revalidateï¼ˆéæœŸé‡æ–°é©—è­‰ï¼‰
**é©ç”¨ï¼š** å¤–éƒ¨è³‡æºï¼ˆCDNã€å­—é«”ã€åœ°åœ–ï¼‰

```javascript
async function staleWhileRevalidate(request) {
    const cache = await caches.open(RUNTIME_CACHE);
    const cached = await cache.match(request);
    
    // èƒŒæ™¯æ›´æ–°å¿«å–
    const fetchPromise = fetch(request).then(response => {
        if (response.status === 200) {
            cache.put(request, response.clone());
        }
        return response;
    });
    
    // ç«‹å³è¿”å›å¿«å–ï¼ŒåŒæ™‚æ›´æ–°
    return cached || fetchPromise;
}
```

**å„ªå‹¢ï¼š**
- âš¡ å³æ™‚éŸ¿æ‡‰ï¼ˆä½¿ç”¨å¿«å–ï¼‰
- ğŸ”„ èƒŒæ™¯è‡ªå‹•æ›´æ–°
- ğŸ“¶ é›¢ç·š/ç·šä¸Šç„¡ç¸«åˆ‡æ›

---

### 4. App åœ–ç¤ºè¨­è¨ˆ

#### åœ–ç¤ºæª”æ¡ˆ

**æª”æ¡ˆä½ç½®ï¼š**
- [images/icons/icon-192.svg](images/icons/icon-192.svg) - 192x192
- [images/icons/icon-512.svg](images/icons/icon-512.svg) - 512x512

**è¨­è¨ˆå…ƒç´ ï¼š**

##### è¦–è¦ºçµ„æˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ„ è–èª•æ¨¹ï¼ˆç¶ è‰²ï¼‰     â”‚  â† ä¸»è¦å…ƒç´ 
â”‚      â­ æ˜Ÿæ˜Ÿï¼ˆé‡‘è‰²ï¼‰    â”‚  â† æ¨¹é ‚è£é£¾
â”‚   ğŸ”´ğŸŸ¡ğŸ”µ è£é£¾çƒ         â”‚  â† å½©è‰²é»ç¶´
â”‚                         â”‚
â”‚   ğŸ¢ å°åŒ—101 è¼ªå»“      â”‚  â† å°åŒ—æ¨™èªŒ
â”‚   ï¼ˆåŠé€æ˜ç™½è‰²ï¼‰        â”‚
â”‚                         â”‚
â”‚   å°åŒ—                  â”‚  â† æ–‡å­—æ¨™è­˜
â”‚   2025                  â”‚  â† å¹´ä»½
â”‚                         â”‚
â”‚ èƒŒæ™¯ï¼šè–èª•ç´… #c41e3a    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è‰²å½©é…ç½®ï¼š**
- èƒŒæ™¯ï¼šè–èª•ç´… `#c41e3a`
- è–èª•æ¨¹ï¼šç¶ è‰² `#2ecc71`
- æ˜Ÿæ˜Ÿï¼šé‡‘è‰² `#f1c40f`
- è£é£¾çƒï¼šç´… `#e74c3c`ã€é»ƒ `#f1c40f`ã€è— `#3498db`
- å°åŒ—101ï¼šç™½è‰²åŠé€æ˜ `rgba(255,255,255,0.3)`
- æ–‡å­—ï¼šç™½è‰²

**åœ–ç¤ºç‰¹é»ï¼š**
- âœ… SVG æ ¼å¼ï¼ˆç„¡æç¸®æ”¾ï¼‰
- âœ… ç°¡æ½”ç¾ä»£è¨­è¨ˆ
- âœ… è–èª•ä¸»é¡Œé®®æ˜
- âœ… å°åŒ—å…ƒç´ ï¼ˆ101ï¼‰
- âœ… åœ“è§’çŸ©å½¢èƒŒæ™¯
- âœ… Maskable æ”¯æ´ï¼ˆå®‰å…¨å€åŸŸï¼‰

---

### 5. "åŠ åˆ°ä¸»ç•«é¢" å®‰è£æç¤º

#### æª”æ¡ˆï¼š[js/pwa-install.js](js/pwa-install.js)

**åŠŸèƒ½æ¦‚è¦½ï¼š**

##### æ™ºæ…§é¡¯ç¤ºé‚è¼¯
```javascript
// é¡¯ç¤ºæ¢ä»¶æª¢æŸ¥
function showInstallPrompt() {
    // 1. ä¸åœ¨ç¨ç«‹æ¨¡å¼ä¸‹
    if (isStandalone()) return;
    
    // 2. æœªåœ¨7å¤©å…§é—œé–‰
    if (isPromptDismissed()) return;
    
    // 3. æœªæ›¾å®‰è£
    if (localStorage.getItem('pwa-installed')) return;
    
    // 4. ç”¨æˆ¶å·²äº’å‹•5ç§’
    setTimeout(createInstallPrompt, 5000);
}
```

**æç¤º UI è¨­è¨ˆï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ•                               â”‚  â† é—œé–‰æŒ‰éˆ•
â”‚                                  â”‚
â”‚        [åœ–ç¤º 64x64]              â”‚  â† App åœ–ç¤º
â”‚                                  â”‚
â”‚   å®‰è£æ—…éŠæŒ‡å— APP               â”‚  â† æ¨™é¡Œ
â”‚   å°‡æœ¬æ—…éŠæŒ‡å—å®‰è£åˆ°ä¸»ç•«é¢ï¼Œ     â”‚  â† æè¿°
â”‚   éš¨æ™‚æŸ¥çœ‹è¡Œç¨‹è³‡è¨Šï¼Œæ”¯æ´é›¢ç·šç€è¦½ï¼â”‚
â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“¥ ç«‹å³å®‰è£  â”‚ â”‚   ç¨å¾Œ   â”‚  â”‚  â† æ“ä½œæŒ‰éˆ•
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  ğŸ“¦ é›¢ç·šç€è¦½  âš¡ å¿«é€Ÿè¼‰å…¥  ğŸ“± APPé«”é©—  â”‚  â† ç‰¹æ€§
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**CSS æ¨£å¼ï¼š**
```css
.pwa-install-prompt {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: white;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.2);
    z-index: 10000;
    border-radius: 16px 16px 0 0;
}
```

**äº’å‹•ç‰¹æ€§ï¼š**
- âœ… å¾åº•éƒ¨æ»‘å…¥å‹•ç•«
- âœ… åŠé€æ˜é®ç½©
- âœ… éŸ¿æ‡‰å¼è¨­è¨ˆï¼ˆæ‰‹æ©Ÿ/æ¡Œé¢ï¼‰
- âœ… é—œé–‰å¾Œ7å¤©ä¸å†é¡¯ç¤º
- âœ… å®‰è£å¾Œæ°¸ä¹…éš±è—

##### äº‹ä»¶è™•ç†

**1. beforeinstallprompt äº‹ä»¶**
```javascript
window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();              // é˜»æ­¢é è¨­æç¤º
    deferredPrompt = e;              // å„²å­˜äº‹ä»¶
    setTimeout(showInstallPrompt, 5000);  // 5ç§’å¾Œé¡¯ç¤º
});
```

**2. appinstalled äº‹ä»¶**
```javascript
window.addEventListener('appinstalled', () => {
    localStorage.setItem('pwa-installed', 'true');
    // ç§»é™¤æç¤ºUI
});
```

**3. å®‰è£æŒ‰éˆ•é»æ“Š**
```javascript
async function handleInstall() {
    deferredPrompt.prompt();         // é¡¯ç¤ºåŸç”Ÿæç¤º
    const { outcome } = await deferredPrompt.userChoice;
    
    if (outcome === 'accepted') {
        console.log('PWA installed');
    }
}
```

---

### 6. æ›´æ–°é€šçŸ¥

#### è‡ªå‹•æª¢æ¸¬ Service Worker æ›´æ–°

```javascript
navigator.serviceWorker.addEventListener('controllerchange', () => {
    showUpdateNotification();  // é¡¯ç¤ºæ›´æ–°æç¤º
});
```

**æ›´æ–°é€šçŸ¥ UIï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ¨ æ–°ç‰ˆæœ¬å¯ç”¨ï¼            â”‚
â”‚  [é‡æ–°è¼‰å…¥]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é€šçŸ¥ä½ç½®ï¼š** é ‚éƒ¨å±…ä¸­  
**èƒŒæ™¯è‰²ï¼š** è–èª•ç´…  
**è‡ªå‹•é¡¯ç¤ºï¼š** æª¢æ¸¬åˆ°æ–°ç‰ˆæœ¬æ™‚

---

### 7. é›¢ç·šåŠŸèƒ½

#### å®Œå…¨é›¢ç·šæ”¯æ´

**é›¢ç·šå¯ç”¨çš„åŠŸèƒ½ï¼š**
- âœ… å®Œæ•´ç¶²é ç€è¦½
- âœ… æ‰€æœ‰è¡Œç¨‹è³‡è¨Š
- âœ… é ç®—è¨ˆç®—å™¨
- âœ… åœ–ç‰‡ç•«å»Š
- âœ… åˆ—å°åŠŸèƒ½
- âœ… FAQ å…§å®¹
- âœ… ç·Šæ€¥è¯çµ¡è³‡è¨Š

**å—é™åŠŸèƒ½ï¼ˆéœ€ç¶²è·¯ï¼‰ï¼š**
- âŒ Leaflet åœ°åœ–ï¼ˆå¤–éƒ¨ CDNï¼‰
- âŒ Chart.js åœ–è¡¨ï¼ˆå¤–éƒ¨ CDNï¼‰
- âŒ Google Fontsï¼ˆå¤–éƒ¨è³‡æºï¼‰

**é›¢ç·šå¾Œé¦–æ¬¡è¨ªå•æµç¨‹ï¼š**
```
1. ç”¨æˆ¶è¨ªå•ç¶²ç«™ï¼ˆç·šä¸Šï¼‰
   â†“
2. Service Worker å®‰è£
   â†“
3. å¿«å–æ‰€æœ‰æ ¸å¿ƒè³‡æº
   â†“
4. ç”¨æˆ¶é›¢ç·š
   â†“
5. è¨ªå•ç¶²ç«™
   â†“
6. Service Worker å¾å¿«å–æä¾›è³‡æº
   â†“
7. å®Œæ•´åŠŸèƒ½å¯ç”¨ï¼âœ…
```

---

### 8. ç¨ç«‹æ‡‰ç”¨æ¨¡å¼ (Standalone)

#### Display Mode: Standalone

**è¦–è¦ºè®ŠåŒ–ï¼š**

**ç€è¦½å™¨æ¨¡å¼ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† â†’ âŸ³ ğŸ”’ localhost:8000   â”‚  â† ç€è¦½å™¨å·¥å…·åˆ—
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚
â”‚    ç¶²é å…§å®¹                â”‚
â”‚                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¨ç«‹æ¨¡å¼ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å°åŒ—è–èª•éŠ         âš™ï¸ â‹®  â”‚  â† ç³»çµ±ç‹€æ…‹åˆ—
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚
â”‚    ç¶²é å…§å®¹                â”‚  â† å…¨è¢å¹•å…§å®¹
â”‚    ï¼ˆç„¡ç€è¦½å™¨ UIï¼‰         â”‚
â”‚                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¨ç«‹æ¨¡å¼å„ªå‹¢ï¼š**
- âœ… æ²‰æµ¸å¼é«”é©—
- âœ… æ›´å¤§å…§å®¹ç©ºé–“
- âœ… é¡åŸç”Ÿ App æ„Ÿå—
- âœ… ç¨ç«‹è¦–çª—/ä»»å‹™ç®¡ç†
- âœ… å°ˆå±¬åœ–ç¤º

**æª¢æ¸¬ç¨ç«‹æ¨¡å¼ï¼š**
```javascript
function isStandalone() {
    return window.matchMedia('(display-mode: standalone)').matches ||
           window.navigator.standalone;
}
```

**CSS é©é…ï¼š**
```css
@media (display-mode: standalone) {
    /* éš±è—å®‰è£æç¤º */
    .pwa-install-prompt {
        display: none;
    }
    
    /* èª¿æ•´è¦–çª—å®‰å…¨å€åŸŸ */
    body {
        padding-top: env(safe-area-inset-top);
        padding-bottom: env(safe-area-inset-bottom);
    }
}
```

---

### 9. å¿«å–ç®¡ç†

#### ç‰ˆæœ¬æ§åˆ¶

```javascript
const CACHE_NAME = 'taipei-travel-v1.1.0';       // ä¸»è¦å¿«å–
const RUNTIME_CACHE = 'taipei-runtime-v1.1.0';   // åŸ·è¡Œæ™‚å¿«å–
```

**æ›´æ–°æµç¨‹ï¼š**
```
1. ä¿®æ”¹ç¨‹å¼ç¢¼
   â†“
2. æ›´æ–°ç‰ˆæœ¬è™Ÿï¼ˆå¦‚ v1.1.0 â†’ v1.2.0ï¼‰
   â†“
3. éƒ¨ç½²æ–°ç‰ˆæœ¬
   â†“
4. Service Worker æª¢æ¸¬åˆ°è®ŠåŒ–
   â†“
5. å®‰è£æ–° Service Worker
   â†“
6. å•Ÿç”¨æ™‚åˆªé™¤èˆŠå¿«å–
   â†“
7. å¿«å–æ–°è³‡æº
   â†“
8. é€šçŸ¥ç”¨æˆ¶é‡æ–°è¼‰å…¥
```

#### è‡ªå‹•æ¸…ç†èˆŠå¿«å–

```javascript
self.addEventListener('activate', event => {
    event.waitUntil(
        caches.keys().then(cacheNames => {
            return Promise.all(
                cacheNames.map(cacheName => {
                    if (cacheName !== CACHE_NAME && 
                        cacheName !== RUNTIME_CACHE) {
                        return caches.delete(cacheName);
                    }
                })
            );
        })
    );
});
```

#### å®šæœŸæ¸…ç†éæœŸé …ç›®

**æ¸…ç†ç­–ç•¥ï¼š** 7å¤©è‡ªå‹•åˆªé™¤

```javascript
const maxAge = 7 * 24 * 60 * 60 * 1000;  // 7å¤©

// æª¢æŸ¥å¿«å–é …ç›®æ™‚é–“
const cachedTime = new Date(response.headers.get('date')).getTime();
if (now - cachedTime > maxAge) {
    cache.delete(request);
}
```

---

## ğŸ“Š PWA åŠŸèƒ½æª¢æŸ¥æ¸…å–®

### Manifest é…ç½®
- [x] æ‡‰ç”¨ç¨‹å¼åç¨±ï¼ˆnameã€short_nameï¼‰
- [x] æè¿°ï¼ˆdescriptionï¼‰
- [x] èµ·å§‹ URLï¼ˆstart_urlï¼‰
- [x] é¡¯ç¤ºæ¨¡å¼ï¼ˆdisplay: standaloneï¼‰
- [x] ä¸»é¡Œé¡è‰²ï¼ˆtheme_colorã€background_colorï¼‰
- [x] åœ–ç¤ºï¼ˆ192x192ã€512x512ï¼‰
- [x] æ–¹å‘ï¼ˆorientation: portraitï¼‰
- [x] èªè¨€ï¼ˆlang: zh-TWï¼‰
- [x] åˆ†é¡ï¼ˆcategoriesï¼‰
- [x] ç¯„åœï¼ˆscopeï¼‰

### Service Worker
- [x] å®‰è£äº‹ä»¶ï¼ˆinstallï¼‰
- [x] å•Ÿç”¨äº‹ä»¶ï¼ˆactivateï¼‰
- [x] æ””æˆªè«‹æ±‚ï¼ˆfetchï¼‰
- [x] å¿«å–ç­–ç•¥ï¼ˆcache-firstã€network-firstã€stale-while-revalidateï¼‰
- [x] å¿«å–æ ¸å¿ƒè³‡æºï¼ˆHTMLã€CSSã€JSï¼‰
- [x] ç‰ˆæœ¬æ§åˆ¶
- [x] èˆŠå¿«å–æ¸…ç†
- [x] éŒ¯èª¤è™•ç†

### å®‰è£æç¤º
- [x] beforeinstallprompt äº‹ä»¶è™•ç†
- [x] è‡ªè¨‚ UI æç¤º
- [x] å®‰è£æŒ‰éˆ•
- [x] å»¶é²é¡¯ç¤ºï¼ˆ5ç§’ï¼‰
- [x] é—œé–‰/ç¨å¾ŒåŠŸèƒ½
- [x] é‡è¤‡é¡¯ç¤ºæ§åˆ¶ï¼ˆ7å¤©ï¼‰
- [x] å·²å®‰è£æª¢æ¸¬
- [x] ç¨ç«‹æ¨¡å¼æª¢æ¸¬

### é›¢ç·šåŠŸèƒ½
- [x] å®Œæ•´é é¢é›¢ç·šå¯ç”¨
- [x] éœæ…‹è³‡æºå¿«å–
- [x] å‹•æ…‹å…§å®¹å¿«å–
- [x] é›¢ç·šå›é€€æ©Ÿåˆ¶
- [x] ç¶²è·¯ç‹€æ…‹æª¢æ¸¬

### æ›´æ–°æ©Ÿåˆ¶
- [x] Service Worker æ›´æ–°æª¢æ¸¬
- [x] æ›´æ–°é€šçŸ¥ UI
- [x] é‡æ–°è¼‰å…¥åŠŸèƒ½
- [x] ç‰ˆæœ¬è™Ÿç®¡ç†

### åœ–ç¤ºèˆ‡è¦–è¦º
- [x] App åœ–ç¤ºï¼ˆå¤šå°ºå¯¸ï¼‰
- [x] Maskable åœ–ç¤ºæ”¯æ´
- [x] å•Ÿå‹•ç•«é¢é¡è‰²
- [x] ä¸»é¡Œé¡è‰²
- [x] åœ“è§’åœ–ç¤ºè¨­è¨ˆ

---

## ğŸ¯ PWA è©•åˆ†

### Lighthouse PWA å¯©æ ¸é æœŸ

**è©•åˆ†é …ç›®ï¼š**

| é …ç›® | ç‹€æ…‹ | èªªæ˜ |
|------|------|------|
| âœ… Installable | PASS | Manifest å®Œæ•´ï¼Œå¯å®‰è£ |
| âœ… PWA Optimized | PASS | Service Worker æ­£å¸¸é‹ä½œ |
| âœ… Offline Support | PASS | æ ¸å¿ƒåŠŸèƒ½é›¢ç·šå¯ç”¨ |
| âœ… Fast & Reliable | PASS | å¿«å–ç­–ç•¥å„ªåŒ– |
| âœ… User Experience | PASS | ç¨ç«‹æ¨¡å¼ï¼Œæ²‰æµ¸é«”é©— |

**é æœŸè©•åˆ†ï¼š** 95-100 åˆ† â­â­â­â­â­

---

## ğŸ“ æ–°å»º/ä¿®æ”¹æ–‡ä»¶

### æ–°å»ºæ–‡ä»¶ (3 å€‹)

1. **[js/pwa-install.js](js/pwa-install.js)** - PWA å®‰è£åŠŸèƒ½
   - beforeinstallprompt äº‹ä»¶è™•ç†
   - è‡ªè¨‚å®‰è£æç¤º UI
   - æ™ºæ…§é¡¯ç¤ºé‚è¼¯
   - å·²å®‰è£æª¢æ¸¬
   - æ›´æ–°é€šçŸ¥
   - 280+ è¡Œç¨‹å¼ç¢¼

2. **[images/icons/icon-192.svg](images/icons/icon-192.svg)** - 192x192 App åœ–ç¤º
   - è–èª•æ¨¹ä¸»é¡Œ
   - å°åŒ—101 å…ƒç´ 
   - SVG æ ¼å¼ï¼ˆå¯ç¸®æ”¾ï¼‰

3. **[images/icons/icon-512.svg](images/icons/icon-512.svg)** - 512x512 App åœ–ç¤º
   - æ›´è©³ç´°çš„è¨­è¨ˆ
   - æ›´å¤šè£é£¾å…ƒç´ 
   - Maskable æ”¯æ´

### ä¿®æ”¹æ–‡ä»¶ (4 å€‹)

1. **[manifest.json](manifest.json)** - Web App Manifest
   - æ›´æ–°åœ–ç¤ºè·¯å¾‘ï¼ˆSVGï¼‰
   - æ–°å¢ maskable ç”¨é€”
   - å®Œæ•´ PWA é…ç½®

2. **[sw.js](sw.js)** - Service Worker
   - ç‰ˆæœ¬å‡ç´šï¼ˆv1.0.0 â†’ v1.1.0ï¼‰
   - æ–°å¢ print.jsã€pwa-install.js
   - æ–°å¢åœ–ç¤ºå¿«å–
   - å¿«å–æ¸…å–®æ›´æ–°

3. **[index.html](index.html)** - ä¸»é é¢
   - å¼•å…¥ pwa-install.js è…³æœ¬
   - Manifest é€£çµå·²å­˜åœ¨ï¼ˆStep 13ï¼‰
   - Service Worker è¨»å†Šå·²å­˜åœ¨ï¼ˆStep 13ï¼‰

4. **[css/main.css](css/main.css)** - ä¸»æ¨£å¼è¡¨
   - PWA å®‰è£æç¤ºæ¨£å¼ï¼ˆ150+ è¡Œï¼‰
   - æ›´æ–°é€šçŸ¥æ¨£å¼
   - éŸ¿æ‡‰å¼é©é…
   - ç¨ç«‹æ¨¡å¼é©é…

---

## âœ¨ PWA åŠŸèƒ½äº®é»

### 1. å®Œæ•´é›¢ç·šé«”é©—
- ğŸ“± å®Œå…¨é›¢ç·šç€è¦½
- ğŸ’¾ æ™ºæ…§å¿«å–ç®¡ç†
- âš¡ æ¥µé€Ÿè¼‰å…¥
- ğŸ”„ è‡ªå‹•åŒæ­¥æ›´æ–°

### 2. åŸç”Ÿ App é«”é©—
- ğŸ–¥ï¸ ç¨ç«‹è¦–çª—æ¨¡å¼
- ğŸ“² åŠ åˆ°ä¸»ç•«é¢
- ğŸ¨ è‡ªè¨‚åœ–ç¤ºèˆ‡ä¸»é¡Œ
- ğŸš€ é¡åŸç”Ÿå•Ÿå‹•

### 3. æ™ºæ…§å®‰è£æç¤º
- â±ï¸ å»¶é²5ç§’é¡¯ç¤º
- ğŸ¯ ç²¾æº–é¡¯ç¤ºé‚è¼¯
- ğŸ” 7å¤©é‡è¤‡æ§åˆ¶
- âœ… å·²å®‰è£æª¢æ¸¬

### 4. è‡ªå‹•æ›´æ–°
- ğŸ” æª¢æ¸¬æ–°ç‰ˆæœ¬
- ğŸ”” é€šçŸ¥ç”¨æˆ¶
- ğŸ”„ ä¸€éµé‡æ–°è¼‰å…¥
- ğŸ—‘ï¸ æ¸…ç†èˆŠå¿«å–

### 5. å¤šå±¤å¿«å–ç­–ç•¥
- ğŸƒ Cache-Firstï¼ˆéœæ…‹ï¼‰
- ğŸŒ Network-Firstï¼ˆå‹•æ…‹ï¼‰
- ğŸ”„ Stale-While-Revalidateï¼ˆCDNï¼‰

---

## ğŸ§ª æ¸¬è©¦æ–¹å¼

### 1. Lighthouse PWA å¯©æ ¸

**æ­¥é©Ÿï¼š**
1. é–‹å•Ÿ Chrome DevTools
2. åˆ‡æ›åˆ° Lighthouse é ç±¤
3. é¸æ“‡ã€ŒProgressive Web Appã€
4. åŸ·è¡Œå¯©æ ¸

**é æœŸçµæœï¼š** 95-100 åˆ†

### 2. é›¢ç·šæ¸¬è©¦

**æ­¥é©Ÿï¼š**
1. è¨ªå•ç¶²ç«™ï¼ˆé¦–æ¬¡è¼‰å…¥ï¼‰
2. é–‹å•Ÿ DevTools â†’ Network
3. å‹¾é¸ã€ŒOfflineã€
4. é‡æ–°è¼‰å…¥é é¢

**é æœŸçµæœï¼š** é é¢å®Œæ•´è¼‰å…¥ï¼Œæ‰€æœ‰åŠŸèƒ½å¯ç”¨

### 3. å®‰è£æ¸¬è©¦

**æ¡Œé¢ç€è¦½å™¨ï¼š**
1. è¨ªå•ç¶²ç«™
2. ç­‰å¾…5ç§’
3. æŸ¥çœ‹å®‰è£æç¤º
4. é»æ“Šã€Œç«‹å³å®‰è£ã€
5. ç¢ºèªå®‰è£

**æ‰‹æ©Ÿç€è¦½å™¨ï¼ˆChrome/Edgeï¼‰ï¼š**
1. è¨ªå•ç¶²ç«™
2. é»æ“Šé¸å–®ï¼ˆâ‹®ï¼‰
3. é¸æ“‡ã€ŒåŠ åˆ°ä¸»ç•«é¢ã€
4. ç¢ºèªå®‰è£

### 4. æ›´æ–°æ¸¬è©¦

**æ­¥é©Ÿï¼š**
1. ä¿®æ”¹ sw.js ç‰ˆæœ¬è™Ÿ
2. é‡æ–°éƒ¨ç½²
3. åˆ·æ–°é é¢
4. æŸ¥çœ‹æ›´æ–°é€šçŸ¥

### 5. Service Worker æª¢æŸ¥

**Chrome DevToolsï¼š**
1. Application é ç±¤
2. Service Workers å€å¡Š
3. ç¢ºèªç‹€æ…‹ï¼šactivated and is running
4. æª¢æŸ¥ Cache Storage

---

## ğŸ“ˆ PWA å„ªå‹¢

### ä½¿ç”¨è€…é«”é©—
- âœ… å¿«é€Ÿè¼‰å…¥ï¼ˆå¿«å–ï¼‰
- âœ… é›¢ç·šå¯ç”¨
- âœ… å…¨è¢å¹•é«”é©—
- âœ… æ¨æ’­é€šçŸ¥ï¼ˆå¯æ“´å±•ï¼‰
- âœ… èƒŒæ™¯åŒæ­¥ï¼ˆå¯æ“´å±•ï¼‰

### æŠ€è¡“å„ªå‹¢
- âœ… ç„¡éœ€ App Store
- âœ… è‡ªå‹•æ›´æ–°
- âœ… è·¨å¹³å°æ”¯æ´
- âœ… SEO å‹å¥½
- âœ… HTTPS å®‰å…¨

### å•†æ¥­åƒ¹å€¼
- âœ… æå‡ç”¨æˆ¶ç•™å­˜
- âœ… æ¸›å°‘é–‹ç™¼æˆæœ¬
- âœ… æ›´å¥½çš„è½‰åŒ–ç‡
- âœ… é™ä½æµé‡æ¶ˆè€—

---

## ğŸ¯ Step 16 å®Œæˆç‹€æ…‹

```
âœ… Web App Manifest é…ç½®å®Œæ•´
âœ… Service Worker å¿«å–ç­–ç•¥å¯¦ç¾
âœ… App åœ–ç¤ºè¨­è¨ˆèˆ‡å‰µå»ºï¼ˆSVGï¼‰
âœ… "åŠ åˆ°ä¸»ç•«é¢" å®‰è£æç¤º
âœ… æ™ºæ…§å®‰è£é‚è¼¯å¯¦ç¾
âœ… é›¢ç·šåŠŸèƒ½å®Œæ•´æ”¯æ´
âœ… è‡ªå‹•æ›´æ–°æª¢æ¸¬èˆ‡é€šçŸ¥
âœ… ç¨ç«‹æ‡‰ç”¨æ¨¡å¼å•Ÿç”¨
âœ… å¿«å–ç‰ˆæœ¬ç®¡ç†
âœ… å¤šå±¤å¿«å–ç­–ç•¥
âœ… PWA å¯©æ ¸å°±ç·’
âœ… å®Œæ•´æ–‡æª”å»ºç«‹
```

---

## ğŸ”§ é€²éšåŠŸèƒ½ï¼ˆæœªä¾†æ“´å±•ï¼‰

### 1. æ¨æ’­é€šçŸ¥
```javascript
// è«‹æ±‚é€šçŸ¥æ¬Šé™
Notification.requestPermission().then(permission => {
    if (permission === 'granted') {
        // ç™¼é€é€šçŸ¥
    }
});
```

### 2. èƒŒæ™¯åŒæ­¥
```javascript
// è¨»å†ŠèƒŒæ™¯åŒæ­¥
navigator.serviceWorker.ready.then(reg => {
    return reg.sync.register('sync-data');
});
```

### 3. Web Share API
```javascript
// åˆ†äº«åŠŸèƒ½
navigator.share({
    title: 'å°åŒ—è–èª•ä¹‹æ—… 2025',
    url: window.location.href
});
```

### 4. é›¢ç·šè¡¨å–®æäº¤
```javascript
// é›¢ç·šæ™‚å„²å­˜è¡¨å–®
if (!navigator.onLine) {
    localStorage.setItem('pendingForm', formData);
}
```

---

**Step 16: Progressive Web App Features - 100% å®Œæˆ! ğŸ“±**

**ä¸‹ä¸€æ­¥: Step 17 - Testing & Quality Assurance ğŸ§ª**

è£½ä½œæ—¥æœŸ: 2025-12-22
PWA å¯©æ ¸: é æœŸ 95-100 åˆ† âœ…
é›¢ç·šæ”¯æ´: å®Œæ•´å¯¦ç¾ âœ…
å®‰è£æç¤º: æ™ºæ…§é¡¯ç¤º âœ…
åœ–ç¤ºè¨­è¨ˆ: SVG å¯ç¸®æ”¾ âœ…
